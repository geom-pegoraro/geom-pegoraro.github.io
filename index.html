<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Geom. Pegoraro Alex — Tavole Sinotiche in 24h</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:ital,wght@0,300;0,400;0,500;0,600;1,300&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --bg:       #0f1117;
    --bg2:      #161b26;
    --bg3:      #1c2233;
    --border:   rgba(255,255,255,0.07);
    --border2:  rgba(255,255,255,0.13);
    --text:     #dde4f0;
    --muted:    #6e7d96;
    --dim:      #3d4a5e;
    --red:      #c0392b;
    --red-s:    rgba(192,57,43,0.10);
    --red-b:    rgba(192,57,43,0.30);
    --yellow:   #c9970a;
    --yellow-s: rgba(201,151,10,0.09);
    --yellow-b: rgba(201,151,10,0.28);
    --green:    #1e8449;
    --green-s:  rgba(30,132,73,0.10);
    --green-b:  rgba(30,132,73,0.32);
    --font: 'Inter', sans-serif;
    --mono: 'DM Mono', monospace;
    --r: 3px;
  }

  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
  html { scroll-behavior: smooth; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: var(--font);
    font-weight: 300;
    font-size: 15px;
    line-height: 1.65;
    -webkit-font-smoothing: antialiased;
    overflow-x: hidden;
  }

  body::before {
    content: '';
    position: fixed; inset: 0;
    background-image:
      linear-gradient(rgba(255,255,255,0.018) 1px, transparent 1px),
      linear-gradient(90deg, rgba(255,255,255,0.018) 1px, transparent 1px);
    background-size: 44px 44px;
    pointer-events: none;
    z-index: 0;
  }

  .wrap {
    max-width: 840px;
    margin: 0 auto;
    padding: 0 22px;
    position: relative;
    z-index: 1;
  }

  /* ── TYPOGRAPHY ── */
  h1 {
    font-size: clamp(2rem, 4.5vw, 3rem);
    font-weight: 600;
    line-height: 1.12;
    letter-spacing: -0.03em;
    color: #fff;
  }
  h2 {
    font-size: clamp(1.2rem, 2.2vw, 1.55rem);
    font-weight: 600;
    letter-spacing: -0.02em;
    color: #fff;
    margin-bottom: 24px;
  }
  .label-tag {
    font-family: var(--mono);
    font-size: 0.62rem;
    letter-spacing: 0.14em;
    text-transform: uppercase;
    color: var(--dim);
    margin-bottom: 8px;
  }

  /* ── HEADER ── */
  header {
    position: relative; z-index: 1;
    border-bottom: 1px solid var(--border);
    padding: 17px 0;
  }
  .hdr {
    max-width: 840px;
    margin: 0 auto;
    padding: 0 22px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 12px;
    flex-wrap: wrap;
  }
  .hdr-name {
    font-size: 0.9rem;
    font-weight: 600;
    color: #fff;
    letter-spacing: -0.01em;
  }
  .hdr-sub {
    font-family: var(--mono);
    font-size: 0.62rem;
    color: var(--muted);
    letter-spacing: 0.08em;
    text-transform: uppercase;
    margin-top: 2px;
  }
  .hdr-pill {
    font-family: var(--mono);
    font-size: 0.62rem;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: var(--red);
    border: 1px solid var(--red-b);
    background: var(--red-s);
    padding: 5px 13px;
    border-radius: 2px;
  }

  /* ── HERO ── */
  .hero {
    padding: 80px 0 64px;
    border-bottom: 1px solid var(--border);
    position: relative; z-index: 1;
  }
  .hero-eye {
    font-family: var(--mono);
    font-size: 0.67rem;
    letter-spacing: 0.14em;
    text-transform: uppercase;
    color: var(--yellow);
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .hero-eye::before {
    content: '';
    display: block;
    width: 26px; height: 1px;
    background: var(--yellow);
    flex-shrink: 0;
  }
  .hero h1 { margin-bottom: 20px; }
  .hero h1 .cr { color: var(--red); }
  .hero h1 .cy { color: var(--yellow); }
  .hero-desc {
    font-size: 0.97rem;
    color: var(--muted);
    max-width: 500px;
    line-height: 1.8;
    margin-bottom: 36px;
  }
  .btn {
    display: inline-block;
    background: var(--red);
    color: #fff;
    text-decoration: none;
    padding: 13px 28px;
    font-size: 0.82rem;
    font-weight: 500;
    letter-spacing: 0.07em;
    text-transform: uppercase;
    border-radius: var(--r);
    border: 1px solid var(--red);
    transition: background 0.16s, color 0.16s;
    cursor: pointer;
    font-family: var(--font);
  }
  .btn:hover { background: transparent; color: var(--red); }

  .kpis {
    margin-top: 52px;
    padding-top: 36px;
    border-top: 1px solid var(--border);
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 20px;
  }
  .kpi { border-left: 1px solid var(--border); padding-left: 18px; }
  .kpi-v {
    font-size: 2rem;
    font-weight: 600;
    color: #fff;
    letter-spacing: -0.03em;
    line-height: 1;
    margin-bottom: 4px;
  }
  .kpi-l {
    font-family: var(--mono);
    font-size: 0.62rem;
    color: var(--muted);
    letter-spacing: 0.08em;
    text-transform: uppercase;
  }

  /* ── SECTIONS ── */
  .sec {
    padding: 58px 0;
    border-bottom: 1px solid var(--border);
    position: relative; z-index: 1;
  }

  /* ── BOX STYLES ── */
  .box-red {
    background: var(--red-s);
    border: 1px solid var(--red-b);
    border-left: 3px solid var(--red);
    border-radius: var(--r);
    padding: 22px 26px;
    margin-bottom: 20px;
  }
  .box-red .bx-tag {
    font-family: var(--mono);
    font-size: 0.63rem;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: var(--red);
    margin-bottom: 10px;
  }
  .box-red p { font-size: 0.88rem; color: var(--text); line-height: 1.82; }

  .box-yellow {
    background: var(--yellow-s);
    border: 1px solid var(--yellow-b);
    border-left: 3px solid var(--yellow);
    border-radius: var(--r);
    padding: 14px 20px;
    font-size: 0.85rem;
    color: var(--text);
    line-height: 1.75;
    margin: 18px 0;
  }

  /* ── CHECKBOX ── */
  .chk-row {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: var(--r);
    padding: 15px 18px;
    margin-top: 12px;
    cursor: pointer;
    transition: border-color 0.14s;
  }
  .chk-row:hover { border-color: var(--border2); }

  .chk-row input[type="checkbox"] {
    appearance: none;
    -webkit-appearance: none;
    width: 17px; height: 17px;
    min-width: 17px;
    border: 1px solid var(--dim);
    background: transparent;
    border-radius: 2px;
    cursor: pointer;
    margin-top: 2px;
    position: relative;
    transition: background 0.14s, border-color 0.14s;
  }
  .chk-row input[type="checkbox"]:checked {
    background: var(--red);
    border-color: var(--red);
  }
  .chk-row input[type="checkbox"]:checked::after {
    content: '✓';
    position: absolute;
    top: 50%; left: 50%;
    transform: translate(-50%,-50%);
    color: #fff;
    font-size: 10px;
    font-weight: 700;
    line-height: 1;
  }
  .chk-row label {
    font-size: 0.86rem;
    color: var(--muted);
    cursor: pointer;
    line-height: 1.65;
  }

  /* ── REQ GRID ── */
  .req-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    margin-bottom: 18px;
  }
  .req-card {
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: var(--r);
    padding: 18px 20px;
  }
  .req-card .rc-tag {
    font-family: var(--mono);
    font-size: 0.6rem;
    color: var(--yellow);
    letter-spacing: 0.1em;
    text-transform: uppercase;
    margin-bottom: 7px;
    display: block;
  }
  .req-card p { font-size: 0.85rem; color: var(--muted); line-height: 1.7; }
  .req-card strong { color: var(--text); font-weight: 500; }

  /* ── PRICING ── */
  .pricing-table {
    width: 100%;
    border-collapse: collapse;
    border: 1px solid var(--border);
    border-radius: var(--r);
    overflow: hidden;
    margin-bottom: 16px;
  }
  .pricing-table thead tr { background: var(--bg3); }
  .pricing-table th {
    font-family: var(--mono);
    font-size: 0.6rem;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: var(--dim);
    padding: 11px 17px;
    text-align: left;
    border-bottom: 1px solid var(--border);
  }
  .pricing-table td {
    padding: 14px 17px;
    font-size: 0.87rem;
    color: var(--muted);
    border-bottom: 1px solid var(--border);
    vertical-align: middle;
  }
  .pricing-table tr:last-child td { border-bottom: none; }
  .pricing-table tbody tr:hover td { background: var(--bg2); }
  .td-name { color: var(--text) !important; font-weight: 500; }
  .td-price {
    font-size: 1.25rem !important;
    font-weight: 600;
    color: #fff !important;
    letter-spacing: -0.02em;
  }
  .pricing-note {
    font-family: var(--mono);
    font-size: 0.68rem;
    color: var(--dim);
    line-height: 2;
  }

  /* ── WORKFLOW ── */
  .wf {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    border: 1px solid var(--border);
    border-radius: var(--r);
    overflow: hidden;
    margin-bottom: 8px;
  }
  .wf-s {
    background: var(--bg2);
    padding: 20px 16px;
    border-right: 1px solid var(--border);
  }
  .wf-s:last-child { border-right: none; }
  .wf-n {
    font-family: var(--mono);
    font-size: 0.58rem;
    color: var(--dim);
    letter-spacing: 0.1em;
    margin-bottom: 7px;
    display: block;
  }
  .wf-t { font-size: 0.83rem; font-weight: 500; color: var(--text); margin-bottom: 4px; }
  .wf-d { font-size: 0.76rem; color: var(--muted); line-height: 1.6; }

  /* ── FORM ── */
  .form-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 14px;
  }
  .fg { display: flex; flex-direction: column; gap: 7px; }
  .fg.full { grid-column: 1 / -1; }

  .fg label {
    font-family: var(--mono);
    font-size: 0.61rem;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: var(--dim);
  }
  .fg label .req { color: var(--red); }

  .fg input[type="text"],
  .fg input[type="email"],
  .fg input[type="tel"],
  .fg textarea {
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: var(--r);
    color: var(--text);
    padding: 11px 14px;
    font-family: var(--font);
    font-size: 0.9rem;
    font-weight: 300;
    outline: none;
    width: 100%;
    transition: border-color 0.14s;
  }
  .fg input:focus,
  .fg textarea:focus { border-color: var(--border2); }
  .fg textarea { resize: vertical; min-height: 88px; }

  /* File input */
  .fg input[type="file"] {
    background: var(--bg2);
    border: 1px dashed var(--border);
    border-radius: var(--r);
    color: var(--muted);
    padding: 22px 16px;
    font-family: var(--mono);
    font-size: 0.72rem;
    width: 100%;
    cursor: pointer;
    transition: border-color 0.14s;
  }
  .fg input[type="file"]:hover { border-color: var(--border2); }
  .fg input[type="file"]::file-selector-button {
    background: var(--bg3);
    border: 1px solid var(--border2);
    border-radius: var(--r);
    color: var(--text);
    padding: 7px 14px;
    font-family: var(--mono);
    font-size: 0.68rem;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    cursor: pointer;
    margin-right: 14px;
    transition: background 0.14s;
  }
  .fg input[type="file"]::file-selector-button:hover { background: var(--border2); }

  .zip-box {
    background: var(--bg3);
    border: 1px solid var(--border);
    border-radius: var(--r);
    padding: 16px 20px;
    margin-top: 10px;
  }
  .zip-box p {
    font-family: var(--mono);
    font-size: 0.7rem;
    color: var(--muted);
    line-height: 1.95;
  }
  .zip-box .zy { color: var(--yellow); }
  .zip-box .zt { color: var(--text); font-weight: 500; }

  /* Submit */
  .submit-area {
    margin-top: 28px;
    padding-top: 24px;
    border-top: 1px solid var(--border);
    display: flex;
    flex-direction: column;
    gap: 10px;
  }
  .submit-row {
    display: flex;
    align-items: center;
    gap: 20px;
    flex-wrap: wrap;
    margin-top: 8px;
  }
  .submit-hint {
    font-family: var(--mono);
    font-size: 0.67rem;
    color: var(--dim);
    line-height: 1.8;
  }

  button[type="submit"] {
    background: var(--red);
    color: #fff;
    border: 1px solid var(--red);
    border-radius: var(--r);
    padding: 13px 32px;
    font-family: var(--font);
    font-size: 0.84rem;
    font-weight: 500;
    letter-spacing: 0.07em;
    text-transform: uppercase;
    cursor: pointer;
    transition: background 0.16s, color 0.16s;
    white-space: nowrap;
  }
  button[type="submit"]:hover { background: transparent; color: var(--red); }

  /* ── FOOTER ── */
  footer {
    position: relative; z-index: 1;
    border-top: 1px solid var(--border);
    padding: 36px 0 28px;
  }
  .ft {
    max-width: 840px;
    margin: 0 auto;
    padding: 0 22px;
    display: grid;
    grid-template-columns: 1fr auto;
    gap: 20px;
    align-items: center;
  }
  .ft-info p {
    font-family: var(--mono);
    font-size: 0.68rem;
    color: var(--dim);
    line-height: 2.1;
  }
  .ft-info a { color: var(--muted); text-decoration: none; }
  .ft-info a:hover { color: var(--text); }
  .ft-name {
    font-size: 0.85rem;
    font-weight: 600;
    color: var(--text);
    font-family: var(--font);
    margin-bottom: 4px;
  }
  .ft-right {
    font-family: var(--mono);
    font-size: 0.62rem;
    color: var(--dim);
    text-align: right;
    line-height: 2;
  }
  .ft-legal {
    max-width: 840px;
    margin: 18px auto 0;
    padding: 16px 22px 0;
    border-top: 1px solid var(--border);
    font-family: var(--mono);
    font-size: 0.61rem;
    color: var(--dim);
    line-height: 1.85;
  }

  /* ── RESPONSIVE ── */
  @media (max-width: 620px) {
    .hero { padding: 52px 0 44px; }
    .kpis { grid-template-columns: 1fr 1fr; }
    .req-grid { grid-template-columns: 1fr; }
    .wf { grid-template-columns: 1fr 1fr; }
    .wf-s { border-right: none; border-bottom: 1px solid var(--border); }
    .wf-s:nth-child(odd) { border-right: 1px solid var(--border); }
    .wf-s:nth-child(3), .wf-s:nth-child(4) { border-bottom: none; }
    .form-grid { grid-template-columns: 1fr; }
    .ft { grid-template-columns: 1fr; }
    .ft-right { text-align: left; }
    .submit-row { flex-direction: column; align-items: flex-start; }
    button[type="submit"] { width: 100%; text-align: center; }
    .pricing-table th:nth-child(3),
    .pricing-table td:nth-child(3) { display: none; }
  }

  @keyframes up {
    from { opacity: 0; transform: translateY(14px); }
    to   { opacity: 1; transform: translateY(0); }
  }
  .hero-eye { animation: up 0.45s ease both 0.05s; }
  .hero h1  { animation: up 0.45s ease both 0.13s; }
  .hero-desc{ animation: up 0.45s ease both 0.21s; }
  .btn      { animation: up 0.45s ease both 0.29s; }
  .kpis     { animation: up 0.45s ease both 0.37s; }

  /* ── OVERLAY DI STATO ── */
  #form-overlay {
    display: none;
    position: fixed; inset: 0; z-index: 999;
    background: rgba(10, 12, 18, 0.96);
    backdrop-filter: blur(6px);
    align-items: center;
    justify-content: center;
    flex-direction: column;
    gap: 28px;
    padding: 32px;
    text-align: center;
  }
  #form-overlay.active { display: flex; }

  .ov-seal {
    font-family: var(--mono);
    font-size: 0.6rem;
    letter-spacing: 0.22em;
    text-transform: uppercase;
    color: var(--dim);
    border: 1px solid var(--border2);
    padding: 6px 18px;
    border-radius: 2px;
  }
  .ov-spinner {
    width: 44px; height: 44px;
    border: 2px solid var(--border2);
    border-top-color: var(--red);
    border-radius: 50%;
    animation: spin 1.1s linear infinite;
  }
  @keyframes spin { to { transform: rotate(360deg); } }

  .ov-title {
    font-size: clamp(1rem, 2.5vw, 1.35rem);
    font-weight: 500;
    color: #fff;
    letter-spacing: -0.02em;
    max-width: 520px;
    line-height: 1.5;
  }
  .ov-subtitle {
    font-family: var(--mono);
    font-size: 0.72rem;
    color: var(--muted);
    max-width: 440px;
    line-height: 1.9;
  }
  .ov-progress-wrap {
    width: 280px; height: 2px;
    background: var(--border2);
    border-radius: 2px;
    overflow: hidden;
  }
  .ov-progress-bar {
    height: 100%;
    background: var(--red);
    width: 0%;
    transition: width 0.5s ease;
    border-radius: 2px;
  }
  .ov-check {
    width: 54px; height: 54px;
    border: 2px solid var(--green);
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    font-size: 1.5rem;
    color: var(--green);
    animation: up 0.4s ease both;
  }
  .ov-date {
    font-family: var(--mono);
    font-size: 0.6rem;
    letter-spacing: 0.15em;
    color: var(--dim);
    border-top: 1px solid var(--border);
    padding-top: 18px;
    max-width: 400px;
    line-height: 1.9;
  }
  .ov-error-icon {
    width: 54px; height: 54px;
    border: 2px solid var(--red);
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    font-size: 1.5rem;
    color: var(--red);
  }
  .ov-btn-back {
    background: transparent;
    color: var(--red);
    border: 1px solid var(--red-b);
    border-radius: var(--r);
    padding: 11px 28px;
    font-family: var(--mono);
    font-size: 0.72rem;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    cursor: pointer;
    transition: background 0.16s;
    margin-top: 8px;
  }
  .ov-btn-back:hover { background: var(--red-s); }
  button[type="submit"]:disabled { opacity: 0.45; cursor: not-allowed; }
</style>
</head>
<body>

<!-- HEADER -->
<header>
  <div class="hdr">
    <div>
      <div class="hdr-name">Geom. Pegoraro Alex</div>
      <div class="hdr-sub">Servizi Tecnici Grafici</div>
    </div>
    <div class="hdr-pill">Servizio Attivo — 24h</div>
  </div>
</header>

<!-- HERO -->
<div class="hero">
  <div class="wrap">
    <div class="hero-eye">Elaborazione Tavole Sinotiche</div>
    <h1>Ottimizzazione Tavole<br><span class="cr">Rosso</span> / <span class="cy">Giallo</span><br>in 24h lavorative</h1>
    <p class="hero-desc">Workflow di post-produzione ottimizzato per garantire l'assoluta corrispondenza geometrica tra le fasi progettuali. Supporto grafico tecnico per studi di progettazione.</p>
    <a href="#commissione" class="btn">Invia Commissione →</a>
    <div class="kpis">
      <div class="kpi"><div class="kpi-v">24h</div><div class="kpi-l">Consegna dal saldo</div></div>
      <div class="kpi"><div class="kpi-v">48h</div><div class="kpi-l">Invio parcella</div></div>
      <div class="kpi"><div class="kpi-v">DWG</div><div class="kpi-l">Formato richiesto</div></div>
    </div>
  </div>
</div>

<!-- § 01 DISCLAIMER -->
<div class="sec">
  <div class="wrap">
    <div class="label-tag">§ 01 — Natura del Servizio</div>
    <h2>Disclaimer — Lettura Obbligatoria</h2>
    <div class="box-red">
      <div class="bx-tag">⚠ Avviso Importante</div>
      <p>Il presente servizio è esclusivamente di <strong>supporto grafico tecnico</strong> e <strong>NON costituisce consulenza professionale asseverata</strong> ai sensi della normativa vigente (D.P.R. 380/2001 e s.m.i.).<br><br>
      Le elaborazioni prodotte sono materiale di ausilio alla progettazione e non sostituiscono in alcun modo la verifica, la firma e l'asseverazione di un professionista abilitato iscritto al relativo Albo professionale. Il committente rimane il solo responsabile dell'utilizzo delle tavole prodotte nell'ambito di pratiche edilizie, urbanistiche o di qualsiasi altra natura giuridica.</p>
    </div>
  </div>
</div>

<!-- § 02 REQUISITI -->
<div class="sec">
  <div class="wrap">
    <div class="label-tag">§ 02 — Specifiche Tecniche</div>
    <h2>Requisiti dei File</h2>
    <div class="req-grid">
      <div class="req-card">
        <span class="rc-tag">// Sovrapponibilità</span>
        <p>Le piante <strong>Stato di Fatto</strong> e <strong>Progetto</strong> devono essere perfettamente sovrapponibili: stesso sistema di riferimento, stessa origine geometrica, stessa scala assoluta.</p>
      </div>
      <div class="req-card">
        <span class="rc-tag">// Formato File</span>
        <p>Esclusivamente <strong>.DWG</strong> (AutoCAD 2013 o compatibile), archiviati in un unico <strong>.ZIP</strong> corredato da file <strong>.TXT</strong> con le specifiche dei layer.</p>
      </div>
      <div class="req-card">
        <span class="rc-tag">// Layer e Colori</span>
        <p>Il file .TXT deve indicare il nome esatto e il colore di ogni layer. <strong>Default:</strong> Rosso = demolizioni (post) · Giallo = nuove realizzazioni (ante).</p>
      </div>
      <div class="req-card">
        <span class="rc-tag">// Rigetto Automatico</span>
        <p>File non conformi <strong>non verranno elaborati</strong>. Il committente viene avvisato via mail e può reinviare i file corretti senza costi aggiuntivi entro 5 gg. lavorativi.</p>
      </div>
    </div>
    <div class="box-yellow">
      ⚠ &nbsp;<strong>Attenzione:</strong> File DWG non sovrapponibili verranno rigettati. Verificare l'allineamento delle piante prima dell'invio. La commissione viene annullata senza addebito.
    </div>
  </div>
</div>

<!-- § 03 TARIFFARIO -->
<div class="sec">
  <div class="wrap">
    <div class="label-tag">§ 03 — Tariffario</div>
    <h2>Prezzi e Tempistiche</h2>
    <table class="pricing-table">
      <thead>
        <tr>
          <th>Servizio</th>
          <th>Condizioni</th>
          <th>Prezzo</th>
          <th>Consegna</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="td-name">Tavola Sinottica Standard</td>
          <td>DWG conformi · fino a 2 layer differenziati</td>
          <td><span class="td-price">45€</span></td>
          <td>24h dal saldo</td>
        </tr>
        <tr>
          <td class="td-name">Tavola Sinottica Complessa</td>
          <td>Più di 2 layer o piante multi-piano</td>
          <td><span class="td-price">65€</span></td>
          <td>24h dal saldo</td>
        </tr>
        <tr>
          <td class="td-name">Revisione Post-Consegna</td>
          <td>Modifica per variazione del committente</td>
          <td><span class="td-price">20€</span></td>
          <td>12h dal saldo</td>
        </tr>
      </tbody>
    </table>
    <p class="pricing-note">
      Parcella inviata via mail entro 48h dalla ricezione &nbsp;·&nbsp; Pagamento entro 30gg dalla data fattura<br>
      Metodi: Bonifico bancario · PayPal &nbsp;·&nbsp; Prezzi IVA esclusa
    </p>
  </div>
</div>

<!-- § 04 WORKFLOW -->
<div class="sec">
  <div class="wrap">
    <div class="label-tag">§ 04 — Come Funziona</div>
    <h2>Processo in 4 Passi</h2>
    <div class="wf">
      <div class="wf-s"><span class="wf-n">STEP 01</span><div class="wf-t">Invio Commissione</div><div class="wf-d">Compila il form e allega lo ZIP con DWG + file .TXT specifiche.</div></div>
      <div class="wf-s"><span class="wf-n">STEP 02</span><div class="wf-t">Parcella via Mail</div><div class="wf-d">Ricevi la parcella entro 48h con le coordinate di pagamento.</div></div>
      <div class="wf-s"><span class="wf-n">STEP 03</span><div class="wf-t">Saldo</div><div class="wf-d">Il timer da 24h parte dalla conferma del pagamento ricevuto.</div></div>
      <div class="wf-s"><span class="wf-n">STEP 04</span><div class="wf-t">Consegna File</div><div class="wf-d">Ricevi le tavole elaborate in DWG e PDF entro 24h lavorative.</div></div>
    </div>
  </div>
</div>

<!-- § 05 FORM — Netlify puro, nessun JavaScript sull'invio -->
<div class="sec" id="commissione">
  <div class="wrap">
    <div class="label-tag">§ 05 — Modulo di Commissione</div>
    <h2>Invia la tua Commessa</h2>

    <form id="commessa-form">

      <div class="form-grid">

        <div class="fg">
          <label for="nome">Nome <span class="req">*</span></label>
          <input type="text" id="nome" name="nome" required placeholder="Mario" autocomplete="given-name">
        </div>

        <div class="fg">
          <label for="cognome">Cognome <span class="req">*</span></label>
          <input type="text" id="cognome" name="cognome" required placeholder="Rossi" autocomplete="family-name">
        </div>

        <div class="fg">
          <label for="telefono">Telefono <span class="req">*</span></label>
          <input type="tel" id="telefono" name="telefono" required placeholder="+39 340 000 0000" autocomplete="tel">
        </div>

        <div class="fg">
          <label for="email">Email <span class="req">*</span></label>
          <input type="email" id="email" name="email" required placeholder="mario.rossi@studio.it" autocomplete="email">
        </div>

        <div class="fg full">
          <label for="note">Note Aggiuntive</label>
          <textarea id="note" name="note" placeholder="Numero tavole, layer particolari, scadenze urgenti, specifiche tecniche aggiuntive…"></textarea>
        </div>

        <div class="fg full">
          <label for="file-allegato">File ZIP <span class="req">*</span></label>
          <input type="file" id="file-allegato" name="attachment" accept=".zip" required />
          <div class="zip-box">
            <p>
              <span class="zy">▸ Struttura richiesta nel file ZIP:</span><br>
              — <span class="zt">stato_di_fatto.dwg</span> — Pianta Stato di Fatto<br>
              — <span class="zt">progetto.dwg</span> — Pianta Progetto (sovrapponibile al precedente)<br>
              — <span class="zt">layer_info.txt</span> — Specifiche colori layer <strong style="color:var(--red)">(OBBLIGATORIO)</strong><br><br>
              <span class="zy">▸ Esempio contenuto layer_info.txt:</span><br>
              Layer demolizioni: <span class="zt">DEMOL</span> → Colore: <span style="color:var(--red)">Rosso #FF0000</span><br>
              Layer nuove opere: <span class="zt">NUOVE</span> → Colore: <span style="color:var(--yellow)">Giallo #FFD700</span><br><br>
              <span style="color:var(--dim)">Se il file .TXT non è presente, verrà applicato il default: Rosso = Post / Giallo = Ante.</span>
            </p>
          </div>
        </div>

      </div><!-- /form-grid -->

      <div class="submit-area">

        <!-- CHECKBOX 1 — Disclaimer -->
        <div class="chk-row">
          <input type="checkbox" id="chk1" name="accetto-disclaimer" value="si" required>
          <label for="chk1">Dichiaro di aver compreso che questo è un <strong>servizio di supporto grafico</strong> e <strong>non una consulenza professionale asseverata</strong>. Il sottoscritto rimane il solo responsabile dell'utilizzo delle tavole prodotte.</label>
        </div>

        <!-- CHECKBOX 2 — Sovrapponibilità -->
        <div class="chk-row">
          <input type="checkbox" id="chk2" name="file-sovrapponibili" value="si" required>
          <label for="chk2">Confermo che i file DWG allegati sono <strong>perfettamente sovrapponibili</strong> (Stato di Fatto vs Progetto). Sono consapevole che file non sovrapponibili <strong>non verranno processati</strong> e la commessa sarà rigettata.</label>
        </div>

        <!-- CHECKBOX 3 — Privacy -->
        <div class="chk-row">
          <input type="checkbox" id="chk3" name="accetto-privacy" value="si" required>
          <label for="chk3">Acconsento al trattamento dei dati personali forniti ai fini della gestione della presente commissione, ai sensi del GDPR 2016/679 e del D.Lgs. 196/2003.</label>
        </div>

        <div class="submit-row">
          <button type="submit" id="submit-btn">Invia Commissione →</button>
          <div class="submit-hint">
            Riceverai la parcella entro 48h via mail.<br>
            Consegna entro 24h lavorative dal saldo ricevuto.
          </div>
        </div>

      </div><!-- /submit-area -->

    </form>

  </div>
</div>

<!-- ─────────────────────────────────────────────
     OVERLAY DI STATO — Caricamento / Successo / Errore
     ───────────────────────────────────────────── -->
<div id="form-overlay">

  <!-- STATO: CARICAMENTO -->
  <div id="ov-loading">
    <div class="ov-seal">Trasmissione Sicura · Dossier Riservato</div>
    <div class="ov-spinner"></div>
    <div class="ov-title">Trasferimento dell'essenza in corso...<br>Non interrompere la connessione con il Tribunale.</div>
    <div class="ov-progress-wrap">
      <div class="ov-progress-bar" id="ov-bar"></div>
    </div>
    <div class="ov-subtitle" id="ov-loading-detail">Preparazione pacchetto documentale…</div>
  </div>

  <!-- STATO: SUCCESSO -->
  <div id="ov-success" style="display:none; flex-direction:column; align-items:center; gap:24px;">
    <div class="ov-seal">Protocollazione Completata</div>
    <div class="ov-check">✓</div>
    <div class="ov-title">Dossier ricevuto e registrato nel sistema.</div>
    <div class="ov-subtitle">
      La mole documentale trasmessa è stata acquisita nella sua interezza: ogni elemento fornito è necessario e funzionale all'istruttoria tecnica del caso.<br><br>
      Riceverai conferma e parcella all'indirizzo e-mail indicato entro <strong style="color:var(--text)">48 ore lavorative</strong>.
    </div>
    <div class="ov-date" id="ov-protocol">
      Ref. dossier: —<br>
      Data deposito: —
    </div>
  </div>

  <!-- STATO: ERRORE -->
  <div id="ov-error" style="display:none; flex-direction:column; align-items:center; gap:20px;">
    <div class="ov-seal">Trasmissione Interrotta</div>
    <div class="ov-error-icon">✕</div>
    <div class="ov-title">Connessione con il Tribunale persa.</div>
    <div class="ov-subtitle" id="ov-error-detail">
      Si è verificato un errore durante la trasmissione. Verificare la connessione di rete e riprovare.
    </div>
    <button class="ov-btn-back" onclick="closeOverlay()">← Torna al Modulo</button>
  </div>

</div>

<!-- FOOTER -->
<footer>
  <div class="ft">
    <div class="ft-info">
      <div class="ft-name">Geom. Pegoraro Alex</div>
      <p>Email: <a href="/cdn-cgi/l/email-protection#6b1b0e0c04190a19040a070e130c0e04062b0c060a020745080406"><span class="__cf_email__" data-cfemail="5e2e3b39312c3f2c313f323b26393b31331e39333f3732703d3133">[email&#160;protected]</span></a></p>
      <p>PEC: <a href="/cdn-cgi/l/email-protection#c1a0ada4b9efb1a4a6aeb3a0b3ae81a6a4aeb1a4a2efa8b5"><span class="__cf_email__" data-cfemail="ea8b868f92c49a8f8d85988b9885aa8d8f859a8f89c4839e">[email&#160;protected]</span></a></p>
      <p>P.IVA: 04505080244</p>
    </div>
    <div class="ft-right">
      <div>© 2025 Geom. Pegoraro Alex</div>
      <div>Servizi Tecnici Grafici</div>
    </div>
  </div>
  <div class="ft-legal">
    Il presente sito non costituisce consulenza professionale asseverata. I servizi offerti sono di esclusivo supporto grafico tecnico alla progettazione. P.IVA 04505080244.
  </div>
</footer>

<!-- SOLO JavaScript UI non critico — nessun intercetto del submit -->
<script>
  // ─────────────────────────────────────────────
  // CONFIGURAZIONE — sostituisci con il tuo URL
  // ─────────────────────────────────────────────
  const GAS_ENDPOINT = 'https://script.google.com/macros/s/AKfycbyzy3ScGEmoCptis45wsLx4A4LrumABO7p-6zeiU3zSYBUTHeTyjiyGS6Y_4oizgpTuig/exec';

  // ─────────────────────────────────────────────
  // HELPER: legge un file come Base64
  // ─────────────────────────────────────────────
  function fileToBase64(file) {
    return new Promise((resolve, reject) => {
      const reader = new FileReader();
      reader.onload  = () => resolve(reader.result.split(',')[1]);
      reader.onerror = () => reject(new Error('Lettura file fallita'));
      reader.readAsDataURL(file);
    });
  }

  // ─────────────────────────────────────────────
  // OVERLAY helpers
  // ─────────────────────────────────────────────
  function showOverlay(state) {
    const overlay = document.getElementById('form-overlay');
    overlay.classList.add('active');
    document.getElementById('ov-loading').style.display = (state === 'loading') ? 'flex'  : 'none';
    document.getElementById('ov-success').style.display = (state === 'success') ? 'flex'  : 'none';
    document.getElementById('ov-error').style.display   = (state === 'error')   ? 'flex'  : 'none';
  }

  function closeOverlay() {
    document.getElementById('form-overlay').classList.remove('active');
    document.getElementById('submit-btn').disabled = false;
    document.getElementById('ov-bar').style.width = '0%';
    document.getElementById('ov-loading-detail').textContent = 'Preparazione pacchetto documentale…';
  }

  function setProgress(pct, label) {
    document.getElementById('ov-bar').style.width = pct + '%';
    if (label) document.getElementById('ov-loading-detail').textContent = label;
  }

  // ─────────────────────────────────────────────
  // SUBMIT handler
  // ─────────────────────────────────────────────
  document.getElementById('commessa-form').addEventListener('submit', async function(e) {
    e.preventDefault();

    const form   = e.target;
    const btn    = document.getElementById('submit-btn');
    const fileEl = document.getElementById('file-allegato');

    if (!form.checkValidity()) {
      form.reportValidity();
      return;
    }

    btn.disabled = true;
    showOverlay('loading');
    setProgress(5, 'Lettura documentale in corso…');

    // 1. Leggi il file come Base64
    let attachmentBase64 = null;
    let attachmentName   = null;
    let attachmentSize   = null;

    if (fileEl.files && fileEl.files[0]) {
      const file = fileEl.files[0];
      attachmentName = file.name;
      attachmentSize = file.size;
      try {
        setProgress(20, 'Codifica pacchetto dati…');
        attachmentBase64 = await fileToBase64(file);
        setProgress(55, 'Autenticazione crittografica completata…');
      } catch (err) {
        document.getElementById('ov-error-detail').textContent =
          'Impossibile leggere il file allegato. Verificare che il file non sia corrotto e riprovare.';
        showOverlay('error');
        return;
      }
    }

    // 2. Costruisci il payload JSON
    const payload = {
      nome:               document.getElementById('nome').value.trim(),
      cognome:            document.getElementById('cognome').value.trim(),
      telefono:           document.getElementById('telefono').value.trim(),
      email:              document.getElementById('email').value.trim(),
      note:               document.getElementById('note').value.trim(),
      accetto_disclaimer: document.getElementById('chk1').checked,
      file_sovrapponibili:document.getElementById('chk2').checked,
      accetto_privacy:    document.getElementById('chk3').checked,
      attachment: {
        name:   attachmentName,
        size:   attachmentSize,
        base64: attachmentBase64
      },
      timestamp: new Date().toISOString()
    };

    setProgress(70, 'Trasmissione cifrata al registro…');

    // 3. Invia al Google Apps Script
    try {
      // GAS richiede redirect:follow e niente header Content-Type per evitare CORS preflight
      const response = await fetch(GAS_ENDPOINT, {
        method:   'POST',
        redirect: 'follow',
        body:     JSON.stringify(payload)
      });

      setProgress(95, 'Verifica dell\'integrità del dossier…');

      // response.type può essere 'opaque' dopo redirect GAS — consideriamo successo
      if (!response.ok && response.type !== 'opaque') {
        throw new Error(`Risposta server: ${response.status} ${response.statusText}`);
      }

      setProgress(100, 'Archiviazione completata.');

      // Breve pausa estetica prima del successo
      await new Promise(r => setTimeout(r, 600));

      // Aggiorna il pannello successo con riferimento e data
      const ref  = 'PEG-' + Date.now().toString(36).toUpperCase();
      const data = new Date().toLocaleString('it-IT', {
        day: '2-digit', month: '2-digit', year: 'numeric',
        hour: '2-digit', minute: '2-digit'
      });
      document.getElementById('ov-protocol').innerHTML =
        `Ref. dossier: <strong style="color:var(--text)">${ref}</strong><br>` +
        `Data deposito: ${data}`;

      showOverlay('success');
      form.reset();

    } catch (err) {
      console.error('Errore invio:', err);
      document.getElementById('ov-error-detail').textContent =
        err.message || 'Errore di rete. Verificare la connessione e riprovare.';
      showOverlay('error');
    }
  });
</script>
</body>
</html>
